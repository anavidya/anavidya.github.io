<HTML>
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <title>Document databases</title>
  <LINK href="styles.css" rel="stylesheet" type="text/css">
  </head>
<body>



<!-- Change this code here by copy and pasting your template on line 15 -->
<header class="site-header">

  <div class="wrap title-wrap">
    <a class="site-title" href="/">Document Database example</a>
  </div>

</header>
 <div class="page-content">
      <div class="wrap">
      <div class="post">

  <header class="post-header">
    <h1></h1>
  </header>

  <article class="post-content">
<p>
Document databases are built around semi-structeured data like XML or JSON like type of documents. This is becoming the popular alternative to 
relational databases and sometimes called as NoSQL Database.
These databases allow fundamental operations like create, read, update and delete(CRUD) on documents and their contents.
The querying language is similar to SQL. Adhoc queries, real time aggregations, indexing are some of the transformations possible with the quering language.
These database can perform better on 'Big data' since the database is distributed at their core. 
Documents are stored across multiple servers as they are not dependent.
</p>
<header class="post-header">
    <h1>When to use document Database</h1>
 </header>

<h4>When data is semistructured</h4>
<p>When the data has many columns or attributes which are not filled in yet, or have complicated relationships or 
	have complex nested structures, 
it is preferable to use document database as an alternative.</p>
<h4>When you do have the capacity to model the whole domain at the moment</h4>
<h4> Some of the popular document Databases are mangoDB, amazon Dynamo DB, cassandra and so on.</h4>

<h3> Example using Postgres-as-a-document-DB</h3>
<p> The following packages have to be installed
<ul>
<li>conda install -c conda-forge ipython-sql</li>
<li>conda install -c anaconda psycopg2</li>
</ul>
</p>
<p>Install the latest version of Postgres for your platform from the <a href=" https://www.postgresql.org/download/">Homepage.</a>
Make sure you install all components</p>
<p>To work python and Databases we will be using the SQLAlchemy SQL Toolkit. The SQL Expression Language is a toolkit is used to construct manipulable SQL expressions 
      which can be programmatically constructed, modified, and executed.
An engine has to configured which provides access to a database which can then invoke SQL statements. to create an engine, use 
the create engine call of the SQLAlchemy SQL Toolkit </p>
<div class="fig figcenter fighighlight">
<img class="alignnone size-full wp-image-87" src="/images/connect engine.PNG" alt="lib" width="360" height="82" />
</div>
<p> Lets create a books database which has a table named 'Books' whose data is loaded from a JSON file. JSON(JavaScript Object Notation) 
is a lightweight data-interchange format. 
	<a href = "https://www.json.org/json-en.html">JSON</a> is built on two structures:
<ul>
<li>A collection of name/value pairs</li>
<li>An ordered list of values</li>
</ul>
 </p>
	      <p> Here is a sample of books JSON file</p>
	      <div class="fig figcenter fighighlight">
<img class="alignnone size-full wp-image-87" src="/images/books-json.PNG" alt="lib" width="360" height="82" />
</div>
	      
<p> Next step is to read the JSON file and upload it as a column into the database. We could create a table to enter the details of the books as 'Books'
We are not worried of the number of attributes that we are loading at this point nor about any constraints between the various attributes.
To do this, one of the ways could be to use Pandas library of Python to first convert to a dataframe. Since Postgres cannot accept NULL
we could replace nulls and then convert the contents to a JSONB format and using SQL upload into a table
	in postgres using the connection that we had established earlier. </p>
              <p>We could create a function to read the JSON file and load ito Pstgres as follows</p>
              <div class="fig figcenter fighighlight">
<img class="alignnone size-full wp-image-87" src="/images/func1.PNG" alt="lib" width="360" height="82" />
</div>
<p>To check if the data has been loaded into our database we could execute a simple query which will
return the count of no. of records in the books table.</p>
<div class="fig figcenter fighighlight">
<img class="alignnone size-full wp-image-87" src="/images/books_count.PNG" alt="lib" width="360" height="82" />
</div>
<p>Similarly other queries can also be performed on the Books table if we are able to have prior knowldge of the JSON tree structure.
for example, if we wanted to query on the titles and the publishing date of the book which has 'Educational' as their 'Subject', 
we could perform it as follows.
</p>
<div class="fig figcenter fighighlight">
<img class="alignnone size-full wp-image-87" src="/images/query1.PNG" alt="lib" width="360" height="82" />
</div>                 


      </article>
</div>
</div>
</div>

</body>
</HTML>
